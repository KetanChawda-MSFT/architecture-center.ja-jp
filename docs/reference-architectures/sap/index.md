---
title: "Azure での SAP NetWeaver および SAP HANA のデプロイ"
description: "Azure の高可用性環境で SAP HANA を実行するための実証済みのプラクティス"
author: njray
ms.date: 06/29/2017
ms.openlocfilehash: 27a97103c0c6f305cb8e830d670c8d0ba7e22aa5
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/14/2017
---
# <a name="deploy-sap-netweaver-and-sap-hana-on-azure"></a><span data-ttu-id="fe02c-103">Azure での SAP NetWeaver および SAP HANA のデプロイ</span><span class="sxs-lookup"><span data-stu-id="fe02c-103">Deploy SAP NetWeaver and SAP HANA on Azure</span></span>

<span data-ttu-id="fe02c-104">この参照用アーキテクチャは、Azure の高可用性環境で SAP HANA を実行するための実証済みのプラクティスのセットを示しています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-104">This reference architecture shows a set of proven practices for running SAP HANA in a high availability environment on Azure.</span></span> [<span data-ttu-id="fe02c-105">**以下のソリューションをデプロイします**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-105">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="fe02c-106">![0][0]</span><span class="sxs-lookup"><span data-stu-id="fe02c-106">![0][0]</span></span>

<span data-ttu-id="fe02c-107">*"このアーキテクチャの [Visio ファイル][visio-download]をダウンロードあします。"*</span><span class="sxs-lookup"><span data-stu-id="fe02c-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE]
> <span data-ttu-id="fe02c-108">この参照用アーキテクチャをデプロイするには、SAP 製品と他の Microsoft 以外のテクノロジの適切なライセンスが必要です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-108">Deploying this reference architecture requires appropriate licensing of SAP products and other non-Microsoft technologies.</span></span> <span data-ttu-id="fe02c-109">Microsoft と SAP のパートナーシップに関する情報については、「[SAP HANA on Azure][sap-hana-on-azure]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-109">For information about the partnership between Microsoft and SAP, see [SAP HANA on Azure][sap-hana-on-azure].</span></span>

## <a name="architecture"></a><span data-ttu-id="fe02c-110">アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="fe02c-110">Architecture</span></span>

<span data-ttu-id="fe02c-111">アーキテクチャは、次のコンポーネントで構成されています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-111">The architecture consists of the following components.</span></span>

- <span data-ttu-id="fe02c-112">**仮想ネットワーク (VNet)**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-112">**Virtual network (VNet)**.</span></span> <span data-ttu-id="fe02c-113">VNet は、Azure の論理的に分離されたネットワークの表現です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-113">A VNet is a representation of a logically isolated network in Azure.</span></span> <span data-ttu-id="fe02c-114">この参照用アーキテクチャ内のすべての VM は、同じ VNet にデプロイされます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-114">All of the VMs in this reference architecture are deployed to the same VNet.</span></span> <span data-ttu-id="fe02c-115">VNet はさらにサブネットに分割されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-115">The VNet is further subdivided into subnets.</span></span> <span data-ttu-id="fe02c-116">アプリケーション (SAP NetWeaver)、データベース (SAP HANA)、管理 (Jumpbox)、および Active Directory など、階層ごとに別個のサブネットを作成します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-116">Create a separate subnet for each tier, including application (SAP NetWeaver), database (SAP HANA), management (the jumpbox), and Active Directory.</span></span>

- <span data-ttu-id="fe02c-117">**仮想マシン (VM)**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-117">**Virtual machines (VMs)**.</span></span> <span data-ttu-id="fe02c-118">このアーキテクチャの VM は、複数の個別の階層にグループ化されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-118">The VMs for this architecture are grouped into several distinct tiers.</span></span>

    - <span data-ttu-id="fe02c-119">**SAP NetWeaver**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-119">**SAP NetWeaver**.</span></span> <span data-ttu-id="fe02c-120">SAP ASCS、SAP Web Dispatcher、および SAP アプリケーション サーバーを含みます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-120">Includes SAP ASCS, SAP Web Dispatcher, and the SAP application servers.</span></span> 
    
    - <span data-ttu-id="fe02c-121">**SAP HANA**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-121">**SAP HANA**.</span></span> <span data-ttu-id="fe02c-122">この参照用アーキテクチャは、データベース層の SAP HANA を使用して、単一の [GS5] [ vm-sizes-mem]インスタンスで実行されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-122">This reference architecture uses SAP HANA for the database tier, running on a single [GS5][vm-sizes-mem] instance.</span></span> <span data-ttu-id="fe02c-123">SAP HANA は、GS5 または [Azure ラージ インスタンスの SAP HANA][azure-large-instances] 上にある運用 OLAP ワークロードに対して認定されています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-123">SAP HANA is certified for production OLAP workloads on GS5 or [SAP HANA on Azure Large Instances][azure-large-instances].</span></span> <span data-ttu-id="fe02c-124">この参照用アーキテクチャは、G シリーズおよび M シリーズの Azure 仮想マシン向けです。</span><span class="sxs-lookup"><span data-stu-id="fe02c-124">This reference architecture is for Azure virtual machines in the G-series and M-series.</span></span> <span data-ttu-id="fe02c-125">Azure ラージ インスタンスの SAP HANA に関する情報については、「[SAP HANA on Azure (L インスタンス) の概要とアーキテクチャ][azure-large-instances]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-125">For information about SAP HANA on Azure Large Instances, see [SAP HANA (large instances) overview and architecture on Azure][azure-large-instances].</span></span>
   
    - <span data-ttu-id="fe02c-126">**Jumpbox**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-126">**Jumpbox**.</span></span> <span data-ttu-id="fe02c-127">要塞ホストとも呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-127">Also called a bastion host.</span></span> <span data-ttu-id="fe02c-128">これは、他の VM に接続するために管理者が使用するネットワークの安全な VM です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-128">This is a secure VM on the network that administrators use to connect to the other VMs.</span></span> 
     
    - <span data-ttu-id="fe02c-129">**Windows Server Active Directory (AD) ドメイン コントローラー**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-129">**Windows Server Active Directory (AD) domain controllers.**</span></span> <span data-ttu-id="fe02c-130">ドメイン コント ローラーは、Windows Server フェールオーバー クラスター (下記参照) を構成するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-130">The domain controllers are used to configure the Windows Server Failover Cluster (see below).</span></span>
 
- <span data-ttu-id="fe02c-131">**可用性セット**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-131">**Availability sets**.</span></span> <span data-ttu-id="fe02c-132">SAP Web Dispatcher、SAP アプリケーション サーバー、および SAP ACSC ロールの VM を別個の可用性セットに配置し、各ロールには少なくとも 2 つの VM をプロビジョニングします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-132">Place the VMs for the SAP Web Dispatcher, SAP application server, and SAP ACSC roles into separate availability sets, and provision at least two VMs for each role.</span></span> <span data-ttu-id="fe02c-133">こうすると VM が高度なサービス レベル アグリーメント (SLA) に対応できるようになります。</span><span class="sxs-lookup"><span data-stu-id="fe02c-133">This makes the VMs eligible for a higher service level agreement (SLA).</span></span>
    
- <span data-ttu-id="fe02c-134">**NIC**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-134">**NICs.**</span></span> <span data-ttu-id="fe02c-135">SAP NetWeaver および SAP HANA を実行する VM は、2 つのネットワーク インターフェイス (NIC) を必要とします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-135">The VMs that run SAP NetWeaver and SAP HANA require two network interfaces (NICs).</span></span> <span data-ttu-id="fe02c-136">各 NIC は、異なる種類のトラフィックを分離するために、別のサブネットに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-136">Each NIC is assigned to a different subnet, to segregate different types of traffic.</span></span> <span data-ttu-id="fe02c-137">詳細については、後述する「[推奨事項](#recommendations)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-137">See [Recommendations](#recommendations) below for more information.</span></span>

- <span data-ttu-id="fe02c-138">**Windows Server フェールオーバー クラスター**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-138">**Windows Server Failover Cluster**.</span></span> <span data-ttu-id="fe02c-139">SAP ACSC を実行している VM は、高可用性のためにフェールオーバー クラスターとして構成されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-139">The VMs that run SAP ACSC are configured as a failover cluster for high availability.</span></span> <span data-ttu-id="fe02c-140">フェールオーバー クラスターをサポートするために、SIOS DataKeeper クラスター エディションは、クラスター ノードが所有する独立したディスクをレプリケートすることによって、クラスターの共有ボリューム (CSV) 機能を実行します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-140">To support the failover cluster, SIOS DataKeeper Cluster Edition performs the cluster shared volume (CSV) function by replicating independent disks owned by the cluster nodes.</span></span> <span data-ttu-id="fe02c-141">詳細については、「[Running SAP applications on the Microsoft platform (Microsoft platform での SAP アプリケーションの実行)][running-sap]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-141">For details, see [Running SAP applications on the Microsoft platform][running-sap].</span></span>
    
- <span data-ttu-id="fe02c-142">**ロード バランサー**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-142">**Load balancers.**</span></span> <span data-ttu-id="fe02c-143">2 つ [Azure Load Balancer] [ azure-lb]インスタンスが使用されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-143">Two [Azure Load Balancer][azure-lb] instances are used.</span></span> <span data-ttu-id="fe02c-144">図の左側にある 1 つ目のバランサーは、SAP Web Dispatcher の VM にトラフィックを分散させます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-144">The first, shown on the left of the diagram, distributes traffic to the SAP Web Dispatcher VMs.</span></span> <span data-ttu-id="fe02c-145">この構成は、「[High Availability of the SAP Web Dispatcher (SAP Web Dispatcher の高可用性)][sap-dispatcher-ha]」で説明されている平行 Web Dispatcher を実装しています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-145">This configuration implements the parallel web dispatcher option described in [High Availability of the SAP Web Dispatcher][sap-dispatcher-ha].</span></span> <span data-ttu-id="fe02c-146">右側にある 2 つ目のバランサーは、アクティブかつ正常なノードへの受信接続を転送することで、Windows Server フェールオーバー クラスターでのフェールオーバーを可能にします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-146">The second load balancer, shown on the right, enables failover in the Windows Server Failover Cluster, by directing incoming connections to the active/healthy node.</span></span>

- <span data-ttu-id="fe02c-147">**VPN Gateway**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-147">**VPN Gateway.**</span></span> <span data-ttu-id="fe02c-148">VPN Gateway では、オンプレミス ネットワークを Azure VNet に拡張します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-148">The VPN Gateway extends your on-premises network to the Azure VNet.</span></span> <span data-ttu-id="fe02c-149">ExpressRoute を使用することも可能です。その場合は、パブリック インターネットを通過しない専用のプライベート接続が使用されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-149">You can also use ExpressRoute, which uses a dedicated private connection that does not go over the public Internet.</span></span> <span data-ttu-id="fe02c-150">サンプルのソリューションでは、ゲートウェイをデプロイしていません。</span><span class="sxs-lookup"><span data-stu-id="fe02c-150">The example solution does not deploy the gateway.</span></span> <span data-ttu-id="fe02c-151">詳細については、「[オンプレミス ネットワークの Azure への接続][hybrid-networking]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-151">For more information, see [Connect an on-premises network to Azure][hybrid-networking].</span></span>

## <a name="recommendations"></a><span data-ttu-id="fe02c-152">Recommendations</span><span class="sxs-lookup"><span data-stu-id="fe02c-152">Recommendations</span></span>

<span data-ttu-id="fe02c-153">実際の要件は、ここで説明するアーキテクチャとは異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="fe02c-153">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="fe02c-154">これらの推奨事項は原案として使用してください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-154">Use these recommendations as a starting point.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="fe02c-155">ロード バランサー</span><span class="sxs-lookup"><span data-stu-id="fe02c-155">Load balancers</span></span>

<span data-ttu-id="fe02c-156">[SAP Web Dispatcher] [ sap-dispatcher]は、デュアル スタック サーバー (ABAP と Java) への HTTP(S) トラフィックの負荷分散を処理します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-156">[SAP Web Dispatcher][sap-dispatcher] handles load balancing of HTTP(S) traffic to dual-stack servers (ABAP and Java).</span></span> <span data-ttu-id="fe02c-157">SAP では長年、シングルスタック アプリケーション サーバーを提唱してきたため、デュアルスタック デプロイメント モデルで実行されるアプリケーションは現在、ほとんどありません。</span><span class="sxs-lookup"><span data-stu-id="fe02c-157">SAP has advocated single-stack application servers for years, so very few applications run on a dual-stack deployment model nowadays.</span></span> <span data-ttu-id="fe02c-158">アーキテクチャの図に示された Azure Load Balancer は、SAP Dispatcher の高可用性クラスターを実装します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-158">The Azure load balancer shown in the architecture diagram implements the high availability cluster for the SAP Web Dispatcher.</span></span>

<span data-ttu-id="fe02c-159">アプリケーション サーバーへのトラフィックの負荷分散は、SAP 内で処理されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-159">Load balancing of traffic to the application servers is handled within SAP.</span></span> <span data-ttu-id="fe02c-160">DIAG およびリモート ファンクション コール (RFC) で SAP サーバーに接続する SAPGUI クライアントからのトラフィックの場合、SCS メッセージ サーバーは SAP App Server の[ログオン グループ][logon-groups]を作成して、負荷を分散します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-160">For traffic from SAPGUI clients connecting to a SAP server via DIAG and Remote Function Calls (RFC), the SCS message server balances the load by creating SAP App Server [Logon Groups][logon-groups].</span></span> 

<span data-ttu-id="fe02c-161">SMLG は、SAP セントラル サービスのログオンの負荷分散機能の管理に使用される SAP ABAP トランザクションです。</span><span class="sxs-lookup"><span data-stu-id="fe02c-161">SMLG is an SAP ABAP transaction used to manage the logon load balancing capability of SAP Central Services.</span></span> <span data-ttu-id="fe02c-162">ログオン グループのバックエンド プールには、複数の ABAP アプリケーション サーバーがあります。</span><span class="sxs-lookup"><span data-stu-id="fe02c-162">The backend pool of the logon group has more than one ABAP application server.</span></span> <span data-ttu-id="fe02c-163">ASCS クラスター サービスにアクセスするクライアントは、フロントエンド IP アドレスを使って、Azure Load Balancer に接続します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-163">Clients accessing ASCS cluster services connect to the Azure load balancer through a frontend IP address.</span></span> <span data-ttu-id="fe02c-164">ASCS クラスター仮想ネットワークの名前には、IP アドレスも含まれています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-164">The ASCS cluster virtual network name also has an IP address.</span></span> <span data-ttu-id="fe02c-165">必要に応じて、クラスターをリモートで管理できるように、このアドレスは Azure Load Balancer の追加の IP アドレスに関連付けできます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-165">Optionally, this address can be associated with an additional IP address on the Azure load balancer, so that the cluster can be managed remotely.</span></span>  

### <a name="nics"></a><span data-ttu-id="fe02c-166">NIC</span><span class="sxs-lookup"><span data-stu-id="fe02c-166">NICs</span></span>

<span data-ttu-id="fe02c-167">SAP ランドスケープ管理機能では、さまざまな NIC 上のサーバー トラフィックの分離が必要です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-167">SAP landscape management functions require segregation of server traffic on different NICs.</span></span> <span data-ttu-id="fe02c-168">たとえば、ビジネス データは、管理トラフィックおよびバックアップ トラフィックとは分離する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fe02c-168">For example, business data should be separated from administrative traffic and backup traffic.</span></span> <span data-ttu-id="fe02c-169">複数の NIC を別のサブネットに割り当てると、このデータ分離が可能です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-169">Assigning multiple NICs to different subnets enables this data segregation.</span></span> <span data-ttu-id="fe02c-170">詳細については、「[Building High Availability for SAP NetWeaver and SAP HANA (SAP NetWeaver および SAP HANA の高可用性の構築)][sap-ha]」(PDF) の「Network (ネットワーク)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-170">For more information, see "Network" in [Building High Availability for SAP NetWeaver and SAP HANA][sap-ha] (PDF).</span></span>

<span data-ttu-id="fe02c-171">管理 NIC を管理サブネットに割り当て、データ通信 NIC を別のサブネットに割り当てます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-171">Assign the administration NIC to the management subnet, and assign the data communication NIC to a separate subnet.</span></span> <span data-ttu-id="fe02c-172">構成の詳細については、「[複数の NIC を持つ Windows 仮想マシンの作成と管理][multiple-vm-nics]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-172">For configuration details, see [Create and manage a Windows virtual machine that has multiple NICs][multiple-vm-nics].</span></span>

### <a name="azure-storage"></a><span data-ttu-id="fe02c-173">Azure Storage (Azure Storage)</span><span class="sxs-lookup"><span data-stu-id="fe02c-173">Azure Storage</span></span>

<span data-ttu-id="fe02c-174">すべてデータベース サーバーの VM では、読み取り/書き込みの待機時間に一貫性を得るために Azure Premium Storage を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-174">With all database server VMs, we recommend using Azure Premium Storage for consistent read/write latency.</span></span> <span data-ttu-id="fe02c-175">(A)SCS 仮想マシンなどの SAP アプリケーション サーバーでは、アプリケーション実行はメモリ内で行われ、ログ記録だけにディスクを使用するため、Azure Standard Storage を使用できます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-175">For SAP application servers, including the (A)SCS virtual machines, you can use Azure Standard Storage, because application execution takes place in memory and uses disks for logging only.</span></span>

<span data-ttu-id="fe02c-176">最高の信頼性を得るには、[Azure Managed Disks][managed-disks] の使用を推奨します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-176">For best reliability, we recommend using [Azure Managed Disks][managed-disks].</span></span> <span data-ttu-id="fe02c-177">管理対象ディスクでは可用性セット内の VM のディスクが必ず分離されるため、単一障害点を回避できます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-177">Managed disks ensure that the disks for VMs within an availability set are isolated to avoid single points of failure.</span></span>

> [!NOTE]
> <span data-ttu-id="fe02c-178">現在、この参照用アーキテクチャの Resource Manager テンプレートでは管理対象ディスクは使用されていません。</span><span class="sxs-lookup"><span data-stu-id="fe02c-178">Currently the Resource Manager template for this reference architecture does not use managed disks.</span></span> <span data-ttu-id="fe02c-179">管理対象ディスクを使用するようにテンプレートを更新する予定です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-179">We are planning to update the template to use managed disks.</span></span>

<span data-ttu-id="fe02c-180">高い IOPS とディスク帯域幅のスループットを達成するために、ストレージ ボリュームのパフォーマンス最適化の共通プラクティスが、Azure Storage レイアウトに適用されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-180">To achieve high IOPS and disk bandwidth throughput, the common practices in storage volume performance optimization apply to Azure storage layout.</span></span> <span data-ttu-id="fe02c-181">たとえば、より大きなディスク ボリュームを作成するために複数のディスクをまとめてストライピングすると、IO パフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-181">For example, striping multiple disks together to create a larger disk volume improves IO performance.</span></span> <span data-ttu-id="fe02c-182">変更が頻繁に行われないストレージ コンテンツの読み取りキャッシュを有効にすると、データ取得の速度が向上します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-182">Enabling the read cache on storage content that changes infrequently enhances the speed of data retrieval.</span></span> <span data-ttu-id="fe02c-183">パフォーマンス要件の詳細については、「 [SAP note 1943937 - Hardware Configuration Check Tool (SAP Note 1943937 - ハードウェアの構成チェック ツール)][sap-1943937]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-183">For details about performance requirements, see [SAP note 1943937 - Hardware Configuration Check Tool][sap-1943937].</span></span>

<span data-ttu-id="fe02c-184">バックアップ データ ストアでは、Azure BLOB ストレージの[クール ストレージ層][ cool-blob-storage]を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-184">For the backup data store, we recommend using the [cool storage tier][cool-blob-storage] of Azure Blob storage.</span></span> <span data-ttu-id="fe02c-185">クール ストレージ層は、アクセスの頻度が低く長期保管されるデータを保存するには、コスト効率が高い方法です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-185">The cool storage tier is a cost-effective way to store data that is less frequently accessed and long-lived.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="fe02c-186">拡張性に関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="fe02c-186">Scalability considerations</span></span>

<span data-ttu-id="fe02c-187">SAP アプリケーション レイヤーでは、Azure はスケールアップのための幅広い仮想マシン サイズを提供しています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-187">At the SAP application layer, Azure offers a wide range of virtual machine sizes for scaling up.</span></span> <span data-ttu-id="fe02c-188">詳細な一覧については、「[SAP note 1928533 - SAP Applications on Azure: Supported Products and Azure VM types (SAP Note 1928533 - Azure 上の SAP アプリケーション: サポートされる製品と Azure VM の種類)」][sap-1928533]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-188">For an inclusive list, see [SAP note 1928533 - SAP Applications on Azure: Supported Products and Azure VM Types][sap-1928533].</span></span> <span data-ttu-id="fe02c-189">スケールアウトするには、より多くの VM を可用性セットに追加します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-189">Scale out by adding more VMs to the availability set.</span></span>

<span data-ttu-id="fe02c-190">OLTP および OLAP SAP の両方のアプリケーションを搭載した Azure 仮想マシン上の SAP HANA では、SAP 認定を受けた仮想マシンのサイズが、単一の VM インスタンスを含む GS5 になっています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-190">For SAP HANA on Azure virtual machines with both OLTP and OLAP SAP applications, the SAP-certified virtual machine size is GS5 with a single VM instance.</span></span> <span data-ttu-id="fe02c-191">より大きなワークロードに対応するために、Microsoft では、Microsoft Azure 認定データセンターに共同配置されている物理サーバー上に SAP HANA 向けの [Azure ラージ インスタンス][azure-large-instances]を提供しています。現時点では、単一のインスタンスに対して最大 4 TB のメモリ容量を提供しています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-191">For larger workloads, Microsoft also offers [Azure Large Instances][azure-large-instances] for SAP HANA on physical servers co-located in a Microsoft Azure certified datacenter, which provides up to 4 TB of memory capacity for a single instance at this time.</span></span> <span data-ttu-id="fe02c-192">複数ノードの構成では、最大 32 TB の合計メモリ容量を備えることも可能です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-192">Multi-node configuration is also possible with a total memory capacity of up to 32 TB.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="fe02c-193">可用性に関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="fe02c-193">Availability considerations</span></span>

<span data-ttu-id="fe02c-194">このように、一元化されたデータベース上に SAP アプリケーションを分散してインストールした場合、高可用性を実現するために基本のインストールがレプリケートされます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-194">In this distributed installation of the SAP application on a centralized database, the base installation is replicated to achieve high availability.</span></span> <span data-ttu-id="fe02c-195">アーキテクチャの各レイヤーでは、次のように高可用性の設計が異なります。</span><span class="sxs-lookup"><span data-stu-id="fe02c-195">For each layer of the architecture, the high availability design varies:</span></span>

- <span data-ttu-id="fe02c-196">**Web Dispatcher**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-196">**Web Dispatcher.**</span></span> <span data-ttu-id="fe02c-197">高可用性は、SAP アプリケーション トラフィックによる冗長な SAP Dispatcher インスタンスによって達成されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-197">High availability is achieved with redundant SAP Web Dispatcher instances with SAP application traffic.</span></span> <span data-ttu-id="fe02c-198">SAP ドキュメントの「[SAP Web Dispatcher (SAP Web Dispatcher)][swd]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-198">See [SAP Web Dispatcher][swd] in the SAP Documentation.</span></span>

- <span data-ttu-id="fe02c-199">**ASCS**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-199">**ASCS.**</span></span> <span data-ttu-id="fe02c-200">Azure Windows 仮想マシン上では ASCS の高可用性を実現するために、Windows サーバー フェールオーバー クラスタリングが SIOS DataKeeper と共に使用され、クラスターの共有ボリュームを実装しています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-200">For high availability of ASCS on Azure Windows virtual machines, Windows Sever Failover Clustering is used with SIOS DataKeeper to implement the cluster shared volume.</span></span> <span data-ttu-id="fe02c-201">実装の詳細については、[Azure での SAP ASCS のクラスタリング][clustering]に関するページをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-201">For implementation details, see [Clustering SAP ASCS on Azure][clustering].</span></span>

- <span data-ttu-id="fe02c-202">**アプリケーション サーバー**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-202">**Application servers.**</span></span> <span data-ttu-id="fe02c-203">高可用性は、アプリケーション サーバーのプール内の負荷分散トラフィックによって実現されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-203">High availability is achieved by load balancing traffic within a pool of application servers.</span></span>

- <span data-ttu-id="fe02c-204">**データベース層**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-204">**Database tier.**</span></span> <span data-ttu-id="fe02c-205">この参照用アーキテクチャでは、単一の SAP HANA データベース インスタンスをデプロイしています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-205">This reference architecture deploys a single SAP HANA database instance.</span></span> <span data-ttu-id="fe02c-206">高可用性を実現するためには、複数のインスタンスをデプロイし、HANA System Replication (HSR) を使用して手動フェールオーバーを実装します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-206">For high availability, deploy more than one instance and use HANA System Replication (HSR) to implement manual failover.</span></span> <span data-ttu-id="fe02c-207">自動フェールオーバーを有効にするには、特定の Linux ディストリビューションの HA 拡張機能が必要です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-207">To enable automatic failover, an HA extension for the specific Linux distribution is required.</span></span>

### <a name="disaster-recovery-considerations"></a><span data-ttu-id="fe02c-208">ディザスター リカバリーの考慮事項</span><span class="sxs-lookup"><span data-stu-id="fe02c-208">Disaster recovery considerations</span></span>

<span data-ttu-id="fe02c-209">各層では、さまざまな戦略を利用して、ディザスター リカバリー (DR) の保護を提供しています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-209">Each tier uses a different strategy to provide disaster recovery (DR) protection.</span></span>

- <span data-ttu-id="fe02c-210">**アプリケーション サーバー**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-210">**Application servers.**</span></span> <span data-ttu-id="fe02c-211">SAP アプリケーション サーバーには、ビジネス データが含まれていません。</span><span class="sxs-lookup"><span data-stu-id="fe02c-211">SAP application servers don't contain business data.</span></span> <span data-ttu-id="fe02c-212">Azure での単純な DR 戦略は、別のリージョンで SAP アプリケーション サーバーを作成することです。</span><span class="sxs-lookup"><span data-stu-id="fe02c-212">On Azure, a simple DR strategy is to create SAP application servers in another region.</span></span> <span data-ttu-id="fe02c-213">プライマリ アプリケーション サーバー上で任意の構成変更やカーネル更新を行った場合、同じ変更が DR リージョンの VM にコピーされる必要があります。</span><span class="sxs-lookup"><span data-stu-id="fe02c-213">Upon any configuration changes or kernel updates on the primary application server, the same changes must be copied to VMs in the DR region.</span></span> <span data-ttu-id="fe02c-214">たとえば、カーネルの実行可能ファイルが DR VM にコピーされます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-214">For example, the kernel executables copied to the DR VMs.</span></span>

- <span data-ttu-id="fe02c-215">**SAP セントラル サービス**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-215">**SAP Central Services.**</span></span> <span data-ttu-id="fe02c-216">SAP アプリケーション スタックのこのコンポーネントも、ビジネス データを保持しません。</span><span class="sxs-lookup"><span data-stu-id="fe02c-216">This component of the SAP application stack also doesn't persist business data.</span></span> <span data-ttu-id="fe02c-217">DR リージョンで VM を構築して、SCS ロールを実行できます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-217">You can build a VM in the DR region to run the SCS role.</span></span> <span data-ttu-id="fe02c-218">同期するプライマリ SCS ノードからのコンテンツは、**/sapmnt** 共有コンテンツだけです。</span><span class="sxs-lookup"><span data-stu-id="fe02c-218">The only content from the primary SCS node to synchronize is the **/sapmnt** share content.</span></span> <span data-ttu-id="fe02c-219">また、構成の変更やカーネルの更新がプライマリ SCS サーバー上で発生した場合、これらの変更または更新が DR SCS でも繰り返される必要があります。</span><span class="sxs-lookup"><span data-stu-id="fe02c-219">Also, if configuration changes or kernel updates take place on the primary SCS servers, they must be repeated on the DR SCS.</span></span> <span data-ttu-id="fe02c-220">2 台のサーバーを同期するには、単に定期スケジュールされたコピー ジョブを使用して、**/sapmnt** を DR 側にコピーします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-220">To synchronize the two servers, simply use a regularly scheduled copy job to copy **/sapmnt** to the DR side.</span></span> <span data-ttu-id="fe02c-221">作成、コピー、およびテスト フェールオーバー プロセスの詳細については、「[SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution (SAP NetWeaver: Hyper-V および Microsoft Azure ベースのディザスター リカバリー ソリューション)][sap-netweaver-dr]」をダウンロードして、「4.3.</span><span class="sxs-lookup"><span data-stu-id="fe02c-221">For details about the build, copy, and test failover process, download [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution][sap-netweaver-dr], and refer to "4.3.</span></span> <span data-ttu-id="fe02c-222">SAP SPOF layer (ASCS) (4.3 SAP SPOF レイヤー (ASCS))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-222">SAP SPOF layer (ASCS)."</span></span>

- <span data-ttu-id="fe02c-223">**データベース層**。</span><span class="sxs-lookup"><span data-stu-id="fe02c-223">**Database tier.**</span></span> <span data-ttu-id="fe02c-224">HSR やストレージ レプリケーションなど、HANA でサポートされているレプリケーション ソリューションを使用します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-224">Use HANA-supported replication solutions such as HSR or Storage Replication.</span></span> 

## <a name="manageability-considerations"></a><span data-ttu-id="fe02c-225">管理容易性に関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="fe02c-225">Manageability considerations</span></span>

<span data-ttu-id="fe02c-226">SAP HANA は、基本となる Azure インフラストラクチャを使用したバックアップ機能を備えています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-226">SAP HANA has a backup feature that uses the underlying Azure infrastructure.</span></span> <span data-ttu-id="fe02c-227">Azure 仮想マシンで実行されている SAP HANA データベースをバックアップするために、SAP HANA スナップショットと Azure ストレージ スナップショットの両方が、バックアップ ファイルの一貫性を確保するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-227">To back up the SAP HANA database running on Azure virtual machines, both the SAP HANA snapshot and Azure storage snapshot are used to ensure the consistency of backup files.</span></span> <span data-ttu-id="fe02c-228">詳細については、「[Azure Virtual Machines 上の SAP HANA のバックアップ ガイド][ hana-backup]」および「[Azure Backup サービスについての質問][backup-faq]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-228">For details, see [Backup guide for SAP HANA on Azure Virtual Machines][hana-backup] and the [Azure Backup service FAQ][backup-faq].</span></span>

<span data-ttu-id="fe02c-229">Azure では、インフラストラクチャ全体の[監視と診断][ monitoring]のために、複数の機能を提供しています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-229">Azure provides several functions for [monitoring and diagnostics][monitoring] of the overall infrastructure.</span></span> <span data-ttu-id="fe02c-230">また、Azure 仮想マシン (Linux または Windows) の高度な監視は、Azure Operations Management Suite (OMS) で処理されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-230">Also, enhanced monitoring of Azure virtual machines (Linux or Windows) is handled by Azure Operations Management Suite (OMS).</span></span>

<span data-ttu-id="fe02c-231">SAP インフラストラクチャのリソースとサービス パフォーマンスの SAP ベースでの監視を提供するには、Azure SAP Enhanced Monitoring 拡張機能を使用します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-231">To provide SAP-based monitoring of resources and service performance of the SAP infrastructure, use the Azure SAP Enhanced Monitoring extension.</span></span> <span data-ttu-id="fe02c-232">この拡張機能では、Azure 監視統計情報をオペレーティング システムの監視と DBA Cockpit 機能のための SAP アプリケーションにフィードします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-232">This extension feeds Azure monitoring statistics into the SAP application for operating system monitoring and DBA Cockpit functions.</span></span> 

## <a name="security-considerations"></a><span data-ttu-id="fe02c-233">セキュリティに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="fe02c-233">Security considerations</span></span>

<span data-ttu-id="fe02c-234">SAP は、SAP アプリケーション内でのロールベース アクセスと承認を制御するために、独自のユーザー管理エンジン (UME) を備えています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-234">SAP has its own Users Management Engine (UME) to control role-based access and authorization within the SAP application.</span></span> <span data-ttu-id="fe02c-235">詳細については、「[SAP HANA Security - An Overview (SAP HANA セキュリティ - 概要)][sap-security]」をご覧ください </span><span class="sxs-lookup"><span data-stu-id="fe02c-235">For details, see [SAP HANA Security - An Overview][sap-security].</span></span> <span data-ttu-id="fe02c-236">(アクセスするには、AP Service Marketplace アカウントが必要です)。</span><span class="sxs-lookup"><span data-stu-id="fe02c-236">(A SAP Service Marketplace account is required for access.)</span></span>

<span data-ttu-id="fe02c-237">インフラストラクチャ セキュリティでは、データは転送時および保存時に保護されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-237">For infrastructure security, data is safeguarded in transit and at rest.</span></span> <span data-ttu-id="fe02c-238">[Azure Virtual Machines (VM) 上の SAP NetWeaver の計画と実装][netweaver-on-azure]に関するガイドの「セキュリティに関する考慮事項」 セクションでは、冒頭にネットワーク セキュリティへの対応について記述されています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-238">The “Security considerations” section of the [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide][netweaver-on-azure] begins to address network security.</span></span> <span data-ttu-id="fe02c-239">また、このガイドでは、アプリケーション通信を許可するために、ファイアウォールで開く必要があるネットワーク ポートも指定しています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-239">The guide also specifies the network ports you must open on the firewalls to allow application communication.</span></span> 

<span data-ttu-id="fe02c-240">Windows および Linux IaaS 仮想マシン ディスクを暗号化するには、[Azure Disk Encryption][disk-encryption] を使用できます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-240">To encrypt Windows and Linux IaaS virtual machine disks, you can use [Azure Disk Encryption][disk-encryption].</span></span> <span data-ttu-id="fe02c-241">Azure Disk Encryption では、Windows の BitLocker 機能と Linux の DM-Crypt 機能を使用して、オペレーティング システムおよびデータ ディスクのボリュームの暗号化を提供しています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-241">Azure Disk Encryption uses the BitLocker feature of Windows and the DM-Crypt feature of Linux to provide volume encryption for the operating system and the data disks.</span></span> <span data-ttu-id="fe02c-242">ソリューションは Azure Key Vault と共に動作し、お使いの Key Vault サブスクリプションのディスク暗号化キーとシークレットを制御および管理できます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-242">The solution also works with Azure Key Vault to help you control and manage the disk-encryption keys and secrets in your Key Vault subscription.</span></span> <span data-ttu-id="fe02c-243">仮想マシンのディスク上のデータは暗号化され、お使いの Azure ストレージに保存されます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-243">Data on the virtual machine disks are encrypted at rest in your Azure storage.</span></span>

<span data-ttu-id="fe02c-244">保存されている SAP HANA データの暗号化には、SAP HANA のネイティブ暗号化テクノロジを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-244">For SAP HANA data-at-rest encryption, we recommend using the SAP HANA native encryption technology.</span></span>

> [!NOTE]
> <span data-ttu-id="fe02c-245">同じサーバー上の Azure ディスクの暗号化には、保存されている HANA データの暗号化を使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-245">Don't use the HANA data-at-rest encryption with Azure disk encryption on the same server.</span></span>

<span data-ttu-id="fe02c-246">VNet にあるさまざまなサブネット間のトラフィックを制限するために、[ネットワーク セキュリティ グループ][nsg] (NSG) を使用することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-246">Consider using [network security groups][nsg] (NSGs) to restrict traffic between the various subnets in the VNet.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="fe02c-247">ソリューションのデプロイ方法</span><span class="sxs-lookup"><span data-stu-id="fe02c-247">Deploy the solution</span></span> 

<span data-ttu-id="fe02c-248">この参照用アーキテクチャのデプロイ スクリプトについては、[GitHub][github] をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-248">The deployment scripts for this reference architecture are available on [GitHub][github].</span></span>


### <a name="prerequisites"></a><span data-ttu-id="fe02c-249">前提条件</span><span class="sxs-lookup"><span data-stu-id="fe02c-249">Prerequisites</span></span>

- <span data-ttu-id="fe02c-250">インストールを完了するには、SAP ソフトウェア ダウンロード センターへのアクセスが必要です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-250">You must have access to the SAP Software Download Center to complete the installation.</span></span>
 
- <span data-ttu-id="fe02c-251">最新バージョンの [Azure PowerShell][azure-ps] をインストールします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-251">Install the latest version of [Azure PowerShell][azure-ps].</span></span> 

- <span data-ttu-id="fe02c-252">このデプロイには、51 コアが必要です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-252">This deployment requires 51 cores.</span></span> <span data-ttu-id="fe02c-253">デプロイする前に、お使いのサブスクリプションに VM コアのクォータが十分にあることを確認します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-253">Before deploying, verify that your subscription has sufficient quota for VM cores.</span></span> <span data-ttu-id="fe02c-254">十分にない場合は、Azure ポータルを使用して、クォータを増やすためのサポート要求を発行します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-254">If not, use the Azure portal to submit a support request for more quota.</span></span>
 
- <span data-ttu-id="fe02c-255">このデプロイでは、GS シリーズの VM を使用します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-255">This deployment uses a GS-series VM.</span></span> <span data-ttu-id="fe02c-256">リージョンごとの GS シリーズの可用性については、[このリンク先][region-availability]を確認してください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-256">Check the availability of the GS series per region [here][region-availability].</span></span>

- <span data-ttu-id="fe02c-257">このデプロイのコストを見積もるには、「[料金計算ツール][azure-pricing]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fe02c-257">To estimate the cost of this deployment, see the [Azure Pricing Calculator][azure-pricing].</span></span> 
 
<span data-ttu-id="fe02c-258">この参照用アーキテクチャでは、次の VM をデプロイしています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-258">This reference architecture deploys the following VMs:</span></span>

| <span data-ttu-id="fe02c-259">リソース名</span><span class="sxs-lookup"><span data-stu-id="fe02c-259">Resource name</span></span> | <span data-ttu-id="fe02c-260">VM サイズ</span><span class="sxs-lookup"><span data-stu-id="fe02c-260">VM Size</span></span> | <span data-ttu-id="fe02c-261">目的</span><span class="sxs-lookup"><span data-stu-id="fe02c-261">Purpose</span></span>  |
|---------------|---------|----------|
| <span data-ttu-id="fe02c-262">`ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`</span><span class="sxs-lookup"><span data-stu-id="fe02c-262">`ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`</span></span> | <span data-ttu-id="fe02c-263">DS11v2</span><span class="sxs-lookup"><span data-stu-id="fe02c-263">DS11v2</span></span> | <span data-ttu-id="fe02c-264">SAP セントラル サービス</span><span class="sxs-lookup"><span data-stu-id="fe02c-264">SAP Central Services</span></span> |
| <span data-ttu-id="fe02c-265">`ra-sapApps-vm1` ... `ra-sapApps-vmN`</span><span class="sxs-lookup"><span data-stu-id="fe02c-265">`ra-sapApps-vm1` ... `ra-sapApps-vmN`</span></span> | <span data-ttu-id="fe02c-266">DS11v2</span><span class="sxs-lookup"><span data-stu-id="fe02c-266">DS11v2</span></span> | <span data-ttu-id="fe02c-267">SAP NetWeaver アプリケーション</span><span class="sxs-lookup"><span data-stu-id="fe02c-267">SAP NetWeaver application</span></span> |
| <span data-ttu-id="fe02c-268">`ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`</span><span class="sxs-lookup"><span data-stu-id="fe02c-268">`ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`</span></span> | <span data-ttu-id="fe02c-269">DS11v2</span><span class="sxs-lookup"><span data-stu-id="fe02c-269">DS11v2</span></span> | <span data-ttu-id="fe02c-270">SAP Web Dispatcher</span><span class="sxs-lookup"><span data-stu-id="fe02c-270">SAP Web Dispatcher</span></span> |
| `ra-sap-data-vm1` | <span data-ttu-id="fe02c-271">GS5</span><span class="sxs-lookup"><span data-stu-id="fe02c-271">GS5</span></span> | <span data-ttu-id="fe02c-272">SAP HANA データベース インスタンス</span><span class="sxs-lookup"><span data-stu-id="fe02c-272">SAP HANA database instance</span></span> |
| `ra-sap-jumpbox-vm1` | <span data-ttu-id="fe02c-273">DS1V2</span><span class="sxs-lookup"><span data-stu-id="fe02c-273">DS1V2</span></span> | <span data-ttu-id="fe02c-274">Jumpbox</span><span class="sxs-lookup"><span data-stu-id="fe02c-274">Jumpbox</span></span> |

<span data-ttu-id="fe02c-275">単一の SAP HANA インスタンスがデプロイされます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-275">A single SAP HANA instance is deployed.</span></span> <span data-ttu-id="fe02c-276">アプリケーション VM の場合、デプロイするインスタンス数はテンプレート パラメーターに指定します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-276">For the application VMs, the number of instances to deploy is specified in the template parameters.</span></span>

### <a name="deploy-sap-infrastructure"></a><span data-ttu-id="fe02c-277">SAP インフラストラクチャのデプロイ</span><span class="sxs-lookup"><span data-stu-id="fe02c-277">Deploy SAP infrastructure</span></span>

<span data-ttu-id="fe02c-278">このアーキテクチャは段階的にデプロイすることも一度にデプロイすることもできます。</span><span class="sxs-lookup"><span data-stu-id="fe02c-278">You can deploy this architecture incrementally or all at once.</span></span> <span data-ttu-id="fe02c-279">最初は、各デプロイの手順を確認できるように、段階的なデプロイをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-279">The first time, we recommend an incremental deployment, so that you can see what each deployment step does.</span></span> <span data-ttu-id="fe02c-280">次のいずれかの "*モード*" パラメーターを使用して段階を指定します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-280">Specify the increment using one of the following *mode* parameters</span></span>

| <span data-ttu-id="fe02c-281">Mode</span><span class="sxs-lookup"><span data-stu-id="fe02c-281">Mode</span></span>           | <span data-ttu-id="fe02c-282">実行内容</span><span class="sxs-lookup"><span data-stu-id="fe02c-282">What it does</span></span>                                                                                                            |
|----------------|-----------------------------------------------------|
| <span data-ttu-id="fe02c-283">インフラストラクチャ</span><span class="sxs-lookup"><span data-stu-id="fe02c-283">infrastructure</span></span> | <span data-ttu-id="fe02c-284">Azure にネットワーク インフラストラクチャをデプロイします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-284">Deploys the network infrastructure in Azure.</span></span>        |
| <span data-ttu-id="fe02c-285">ワークロード</span><span class="sxs-lookup"><span data-stu-id="fe02c-285">workload</span></span>       | <span data-ttu-id="fe02c-286">SAP サーバーをネットワークにデプロイします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-286">Deploys the SAP servers to the network.</span></span>             |
| <span data-ttu-id="fe02c-287">すべて</span><span class="sxs-lookup"><span data-stu-id="fe02c-287">all</span></span>            | <span data-ttu-id="fe02c-288">上記のすべてをデプロイします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-288">Deploys all the preceding deployments.</span></span>              |

<span data-ttu-id="fe02c-289">ソリューションをデプロイするには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-289">To deploy the solution, perform the following steps:</span></span>

1. <span data-ttu-id="fe02c-290">[GitHub リポジトリ][github]をローカル コンピューターにダウンロードするか複製します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-290">Download or clone the [GitHub repo][github] to your local computer.</span></span>

2. <span data-ttu-id="fe02c-291">PowerShell ウィンドウを開き、`/sap/sap-hana/` フォルダーに移動します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-291">Open a PowerShell window and navigate to the `/sap/sap-hana/` folder.</span></span>

3. <span data-ttu-id="fe02c-292">次の PowerShell コマンドレットを実行します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-292">Run the following PowerShell cmdlet.</span></span> <span data-ttu-id="fe02c-293">`<subscription id>` には、Azure サブスクリプション ID を使用します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-293">For `<subscription id>`, use your Azure subscription ID.</span></span> <span data-ttu-id="fe02c-294">`<location>` には、Azure リージョン (`eastus` や `westus` など) を指定します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-294">For `<location>`, specify an Azure region, such as `eastus` or `westus`.</span></span> <span data-ttu-id="fe02c-295">`<mode>` には、上記のモードのいずれかを指定します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-295">For `<mode>`, specify one of the modes listed above.</span></span>

    ```powershell
     .\Deploy-ReferenceArchitecture -SubscriptionId <subscription id> -Location <location> -ResourceGroupName <resource group> <mode>
    ```

4.  <span data-ttu-id="fe02c-296">プロンプトが表示されたら、Azure アカウントにログオンします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-296">When prompted, log on to your Azure account.</span></span> 

<span data-ttu-id="fe02c-297">選択したモードによって異なりますが、デプロイ スクリプトは完了するまでに数時間かかることがあります。</span><span class="sxs-lookup"><span data-stu-id="fe02c-297">The deployment scripts can take up to several hours to complete, depending on the mode you selected.</span></span>

> [!WARNING]
> <span data-ttu-id="fe02c-298">パラメーター ファイルには、ハードコーディングされたパスワード (`AweS0me@PW`) がさまざまな場所に含まれています。</span><span class="sxs-lookup"><span data-stu-id="fe02c-298">The parameter files include a hard-coded password (`AweS0me@PW`) in various places.</span></span> <span data-ttu-id="fe02c-299">デプロイする前にこれらの値を変更します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-299">Change these values before you deploy.</span></span>
 
### <a name="configure-sap-applications-and-database"></a><span data-ttu-id="fe02c-300">SAP アプリケーションおよびデータベースの構成</span><span class="sxs-lookup"><span data-stu-id="fe02c-300">Configure SAP applications and database</span></span>

<span data-ttu-id="fe02c-301">SAP インフラストラクチャのデプロイ後、SAP アプリケーションおよび HANA データベースを仮想マシン上に次のようにインストールして構成します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-301">After deploying the SAP infrastructure, install and configure your SAP applications and HANA database on the virtual machines as follows.</span></span>

> [!NOTE]
> <span data-ttu-id="fe02c-302">SAP のインストール手順を確認するには、「[SAP installation guides (SAP インストール ガイド)][sap-guide]」をダウンロードするために、SAP サポート ポータルのユーザー名とパスワードが必要です。</span><span class="sxs-lookup"><span data-stu-id="fe02c-302">For SAP installation instructions, you must have a SAP Support Portal username and password to download the [SAP installation guides][sap-guide].</span></span>

1. <span data-ttu-id="fe02c-303">Jumpbox (`ra-sap-jumpbox-vm1`) へログインします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-303">Log into the jumpbox (`ra-sap-jumpbox-vm1`).</span></span> <span data-ttu-id="fe02c-304">他の VM にログインするために、Jumpbox を使用します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-304">You will use the jumpbox to log into the other VMs.</span></span> 

2.  <span data-ttu-id="fe02c-305">`ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN` という名前の各 VM に対して、VM にログインして、[Web Dispatcher インストール][sap-dispatcher-install]の wiki に記載されている手順を使用して、SAP Web Dispatcher インスタンスをインストールして構成します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-305">For each VM named `ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`, log into the VM, and install and configure the SAP Web Dispatcher instance using the steps described in the [Web Dispatcher Installation][sap-dispatcher-install] wiki.</span></span>

3.  <span data-ttu-id="fe02c-306">`ra-sap-data-vm1` という名前の VM にログインします。</span><span class="sxs-lookup"><span data-stu-id="fe02c-306">Log into the VM named `ra-sap-data-vm1`.</span></span> <span data-ttu-id="fe02c-307">「[SAP HANA Server Installation and Update Guide (SAP HANA サーバーのインストールおよび更新ガイド)][hana-guide]」を使用して、SAP Hana データベース インスタンスをインストールして構成します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-307">Install and configure the SAP Hana Database instance using the [SAP HANA Server Installation and Update Guide][hana-guide].</span></span>

4. <span data-ttu-id="fe02c-308">`ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN` という名前の各 VM に対して、VM にログインして、「[SAP installation guides (SAP インストール ガイド)][sap-guide]」を使用して SAP セントラル サービス (SCS) をインストールして構成します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-308">For each VM named `ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`, log into the VM, and install and configure the SAP Central Services (SCS) using the [SAP installation guides][sap-guide].</span></span>

5.  <span data-ttu-id="fe02c-309">`ra-sapApps-vm1` ... `ra-sapApps-vmN` という名前の各 VM に対して、VM にログインして、「[SAP installation guides (SAP インストール ガイド)][sap-guide]」を使用して SAP NetWeaver アプリケーションをインストールして構成します。</span><span class="sxs-lookup"><span data-stu-id="fe02c-309">For each VM named `ra-sapApps-vm1` ... `ra-sapApps-vmN`, log into the VM, and install and configure the SAP NetWeaver application using the [SAP installation guides][sap-guide].</span></span>

<span data-ttu-id="fe02c-310">**_この参照用アーキテクチャの作成者_** &mdash; Rick Rainey、Ross Sponholtz、Ben Trinh</span><span class="sxs-lookup"><span data-stu-id="fe02c-310">**_Contributors to this reference architecture_** &mdash; Rick Rainey, Ross Sponholtz, Ben Trinh</span></span>

[azure-large-instances]: /azure/virtual-machines/workloads/sap/hana-overview-architecture
[azure-lb]: /azure/load-balancer/load-balancer-overview
[azure-pricing]: https://azure.microsoft.com/pricing/calculator/
[azure-ps]: /powershell/azure/overview
[backup-faq]: /azure/backup/backup-azure-backup-faq
[clustering]: https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/
[cool-blob-storage]: /azure/storage/storage-blob-storage-tiers
[disk-encryption]: /azure/security/azure-security-disk-encryption
[github]: https://github.com/mspnp/reference-architectures/tree/master/sap/sap-hana
[hana-backup]: /azure/virtual-machines/workloads/sap/sap-hana-backup-guide
[hana-guide]: https://help.sap.com/viewer/2c1988d620e04368aa4103bf26f17727/2.0.01/en-US/7eb0167eb35e4e2885415205b8383584.html
[hybrid-networking]: ../hybrid-networking/index.md
[logon-groups]: https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing
[managed-disks]: /azure/storage/storage-managed-disks-overview
[monitoring]: /azure/architecture/best-practices/monitoring
[multiple-vm-nics]: /azure/virtual-machines/windows/multiple-nics
[netweaver-on-azure]: /azure/virtual-machines/workloads/sap/planning-guide
[nsg]: /azure/virtual-network/virtual-networks-nsg
[region-availability]: https://azure.microsoft.com/regions/services/
[running-SAP]: https://blogs.msdn.microsoft.com/saponsqlserver/2016/06/07/sap-on-sql-general-update-for-customers-partners-june-2016/
[sap-1943937]: https://launchpad.support.sap.com/#/notes/1943937
[sap-1928533]: https://launchpad.support.sap.com/#/notes/1928533
[sap-dispatcher]: https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm
[sap-dispatcher-ha]: https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/9a9a6b48c673e8e10000000a42189b/frameset.htm
[sap-dispatcher-install]: https://wiki.scn.sap.com/wiki/display/SI/Web+Dispatcher+Installation
[sap-guide]: https://service.sap.com/instguides
[sap-ha]: https://support.sap.com/content/dam/SAAP/SAP_Activate/AGS_70.pdf
[sap-hana-on-azure]: https://azure.microsoft.com/services/virtual-machines/sap-hana/
[sap-netweaver-dr]: http://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx
[sap-security]: https://archive.sap.com/documents/docs/DOC-62943
[visio-download]: https://archcenter.azureedge.net/cdn/SAP-HANA-architecture.vsdx
[vm-sizes-mem]: /azure/virtual-machines/windows/sizes-memory
[swd]: https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm
[0]: ./images/sap-hana.png "Microsoft Azure を使用した SAP HANA アーキテクチャ"
